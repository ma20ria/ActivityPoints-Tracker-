"use strict";(self.webpackChunkactivity_points_tracker=self.webpackChunkactivity_points_tracker||[]).push([[285],{9285:(y,h,n)=>{n.r(h),n.d(h,{ReportComponent:()=>k});var d=n(177),p=n(2183),c=n(1529),t=n(4438),l=n(8489),u=n(8010),a=n(6354),g=n(1626);let v=(()=>{class r{constructor(e){this.http=e,this.apiUrl="http://localhost:5000/api/users"}getAllUsers(){return this.http.get(this.apiUrl).pipe((0,a.T)(e=>e.data))}getUsersByRole(e){return this.http.get(`${this.apiUrl}/role/${e}`).pipe((0,a.T)(i=>i.data))}getUserById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe((0,a.T)(i=>i.data))}updateUser(e,i){return this.http.put(`${this.apiUrl}/${e}`,i).pipe((0,a.T)(s=>s.data))}deleteUser(e){return this.http.delete(`${this.apiUrl}/${e}`)}getAssignedStudents(e){return this.http.get(`${this.apiUrl}/teacher/${e}/students`).pipe((0,a.T)(i=>i.data))}static{this.\u0275fac=function(i){return new(i||r)(t.KVO(g.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function F(r,o){1&r&&(t.j41(0,"div",9)(1,"div",10)(2,"span",11),t.EFF(3,"Loading..."),t.k0s()(),t.j41(4,"p",12),t.EFF(5,"Loading report data..."),t.k0s()())}function f(r,o){if(1&r&&(t.j41(0,"div",13),t.EFF(1),t.k0s()),2&r){const e=t.XpG();t.R7$(),t.SpI(" ",e.error," ")}}function m(r,o){if(1&r&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s()()),2&r){const e=o.$implicit;t.R7$(2),t.JRh(e.student.name),t.R7$(2),t.JRh(e.student.rollNumber),t.R7$(2),t.JRh(e.student.class),t.R7$(2),t.JRh(e.totalActivities),t.R7$(2),t.JRh(e.approvedActivities),t.R7$(2),t.JRh(e.pendingActivities),t.R7$(2),t.JRh(e.rejectedActivities),t.R7$(2),t.JRh(e.totalPoints)}}function R(r,o){if(1&r&&(t.j41(0,"div",14)(1,"div",15)(2,"div",16)(3,"table",17)(4,"thead")(5,"tr")(6,"th"),t.EFF(7,"Student Name"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Roll Number"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Class"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Total Activities"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Approved"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Pending"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Rejected"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Total Points"),t.k0s()()(),t.j41(22,"tbody"),t.DNE(23,m,17,8,"tr",18),t.k0s()()()()()),2&r){const e=t.XpG();t.R7$(23),t.Y8G("ngForOf",e.reportData)}}function j(r,o){1&r&&(t.j41(0,"div",9)(1,"p",19),t.EFF(2,"No students are currently assigned to you."),t.k0s()())}let k=(()=>{class r{constructor(e,i,s){this.activityService=e,this.authService=i,this.userService=s,this.reportData=[],this.isLoading=!0,this.error=null,this.currentUser=null}ngOnInit(){if(this.currentUser=this.authService.getCurrentUser(),!this.currentUser)return this.error="User not authenticated",void(this.isLoading=!1);this.loadAssignedStudentsReport()}loadAssignedStudentsReport(){if(!this.currentUser?._id)return this.error="User ID not found",void(this.isLoading=!1);this.userService.getAssignedStudents(this.currentUser._id).subscribe({next:e=>{if(!e||0===e.length)return this.reportData=[],void(this.isLoading=!1);const i=e.map(s=>s._id);this.activityService.generateReport({teacherId:this.currentUser._id,studentIds:i.join(",")}).subscribe({next:s=>{this.reportData=s&&s.data?s.data:[],this.isLoading=!1},error:s=>{this.error=s.message||"Failed to load report data",this.isLoading=!1}})},error:e=>{this.error=e.error?.message||"Failed to load assigned students",this.isLoading=!1}})}static{this.\u0275fac=function(i){return new(i||r)(t.rXU(l.T),t.rXU(u.u),t.rXU(v))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-report"]],standalone:!0,features:[t.aNF],decls:13,vars:4,consts:[[1,"container","py-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["routerLink","/dashboard/teacher",1,"btn","btn-outline-primary"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","card shadow-sm",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"alert","alert-danger"],[1,"card","shadow-sm"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[1,"text-muted","mb-0"]],template:function(i,s){1&i&&(t.nrm(0,"app-navbar"),t.j41(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1",4),t.EFF(6,"My Students Activity Report"),t.k0s(),t.j41(7,"a",5),t.EFF(8,"Back to Dashboard"),t.k0s()()()(),t.DNE(9,F,6,0,"div",6)(10,f,2,1,"div",7)(11,R,24,1,"div",8)(12,j,3,0,"div",6),t.k0s()),2&i&&(t.R7$(9),t.Y8G("ngIf",s.isLoading),t.R7$(),t.Y8G("ngIf",s.error),t.R7$(),t.Y8G("ngIf",!s.isLoading&&!s.error&&s.reportData.length>0),t.R7$(),t.Y8G("ngIf",!s.isLoading&&!s.error&&0===s.reportData.length))},dependencies:[d.MD,d.Sq,d.bT,p.Wk,c._],styles:[".shadow-sm[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;background-color:#f8f9fa}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}"]})}}return r})()}}]);